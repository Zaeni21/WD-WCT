<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Force Withdraw WCT</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.7.0/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 100px; }
    button {
      font-size: 20px; padding: 15px 40px;
      background-color: #ff5c5c; color: white;
      border: none; border-radius: 10px; cursor: pointer;
    }
    #status { margin-top: 20px; font-size: 16px; color: #333; }
  </style>
</head>
<body>
  <h2>Force Withdraw WCT</h2>
  <button onclick="forceWithdraw()">Force Withdraw</button>
  <div id="status"></div>

  <script>
    const CONTRACT_ADDRESS = "0x521B4C065Bbdbe3E20B3727340730936912DfA46";
    const ABI = [
      {
        "inputs": [],
        "name": "forceWithdrawAll",
        "outputs": [],
        "stateMutability": "nonpayable",
        "type": "function"
      }
    ];

    async function switchToOP() {
      try {
        await window.ethereum.request({
          method: "wallet_switchEthereumChain",
          params: [{ chainId: "0xa" }],
        });
      } catch (e) {}
    }

    async function forceWithdraw() {
      const status = document.getElementById("status");
      try {
        await switchToOP();
        const provider = new ethers.BrowserProvider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        const signer = await provider.getSigner();
        const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);

        const tx = await contract.forceWithdrawAll();
        status.innerHTML = `Tx sent: <a href="https://optimistic.etherscan.io/tx/${tx.hash}" target="_blank">${tx.hash}</a>`;
        await tx.wait();
        status.innerHTML += "<br>✅ Force Withdraw Confirmed!";
      } catch (err) {
        status.innerText = "❌ Error: " + (err.reason || err.message || err);
      }
    }
  </script>
</body>
</html>
